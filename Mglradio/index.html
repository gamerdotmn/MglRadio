<html ng-app="mglradioapp">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="pragma" content="no-cache" />
        <title>MGL RADIO</title>
        <!--css -->
        <link href="css/ionic.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/animate.css" rel="stylesheet">
        <link href="css/ionic.filter.bar.min.css" rel="stylesheet">
        <link href="css/swiper.min.css" rel="stylesheet">
        <link href="css/custom.css" rel="stylesheet">
        <link href="skin/circle.player.css" rel="stylesheet">
        <!--js-->
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.jplayer.min.js"></script>
        <script type="text/javascript" src="js/jquery.transform2d.js"></script>
        <script type="text/javascript" src="js/jquery.grab.js"></script>
        <script type="text/javascript" src="js/mod.csstransforms.min.js"></script>
        <script type="text/javascript" src="js/circle.player.js"></script>
        <script type="text/javascript" src="js/ionic.bundle.min.js"></script>
        <script type="text/javascript" src="js/swiper.js"></script>
        <script type="text/javascript" src="js/ionic.filter.bar.min.js"></script>
        <script type="text/javascript" src="js/moment.js"></script>
        <script type="text/javascript" src="js/angular-swiper.js"></script>
        <script type="text/javascript" src="js/download.js"></script>
        <script type="text/javascript" src="js/app.js"></script>
        <script type="text/javascript">
            
            var my_media = null;
            var net = false;
            var isplaying = false;
            
            function play() {
                if (my_media===null) {
                    my_media = new Media("http://50.7.76.251:8080/;steam.mp3", 
                                         
                                         function () {
                                             
                                         },
                                         function (err) {
                                             
                                         }
                        ); 
                }
                my_media.play();
                MusicControls.updateIsPlaying(true);
                isplaying = true;
                try {
                document.getElementById("radiodiv").style.backgroundImage = "url(img/bar.gif)";
                }
                catch(err) {}
            }
            
            function pause() {
                my_media.pause();
                MusicControls.updateIsPlaying(false);
                isplaying = false;
                try {
                document.getElementById("radiodiv").style.backgroundImage = "";
                }
                catch(err) {}
            }
            
            function create_success() {
            }
            
            function create_error() {
            }            
            
            
            function events(action) {
                switch (action) {
                    case 'music-controls-pause':
                        pause();
                        break;
                    case 'music-controls-play':
                        play();
                        break;
                    default:
                        break;
                }
            }
            var db;
            var downloadstatus="";
            var downloadanimate="slideInUp";
            var fileTransfer;
            
            document.addEventListener('deviceready', function () {
                
                window.localStorage.removeItem("d_is");
                window.localStorage.removeItem("d_name");
                window.localStorage.removeItem("d_description");
                window.localStorage.removeItem("d_path");
                window.localStorage.removeItem("d_img");
                window.localStorage.removeItem("d_typen");
                window.localStorage.removeItem("d_time");
                window.localStorage.removeItem("d_id");
                
                fileTransfer = new FileTransfer();
                //download.startDownload();
                if(typeof(cordova.plugins)!=="undefined")
                {
                    cordova.plugins.notification.local.on('click', function (notification) {
                        setTimeout(function(){document.location='#/app/radio';}, 2000);
                    });
                }
                if (navigator.onLine) {
                    net = true;
                }
                
                setInterval(function() { 
                    if (navigator.onLine) {
                        if (!net) {
                            net = true;
                            location.reload();
                        }
                    }
                }, 2500);
                
                if (typeof(MusicControls)!=="undefined") {
                    MusicControls.create({
                                             track       : 'FM 102.1',
                                             artist      : '',
                                             isPlaying   : false,
                                             dismissable : false,
                                             hasPrev   : false,
                                             hasNext   : false,
                                             hasClose  : false,
                                         }, create_success, create_error);
                    MusicControls.subscribe(events);
                    MusicControls.listen();
                }
                if(typeof(window.sqlitePlugin)!=="undefined")
                {
                    db = window.sqlitePlugin.openDatabase({name: "mglradio.db"});
                    
                    db.transaction(function(tx) {
                        
                      //tx.executeSql('DROP TABLE IF EXISTS content');
                      tx.executeSql('CREATE TABLE IF NOT EXISTS content (id integer primary key, name text, description text, path text, img text, typen text, time text)', [], function(tx, res) {
                        
                      }, function(error) {
                        console.log('query error: ' + error.message);
                      });
                      
                    }, function(error) {
                      console.log('transaction error: ' + error.message);
                    }, function() {
                      //console.log('query ok');
                    });
                }
            }, false);
            
            function searchval(val) {
                var $body = angular.element(document.body);            
                var $rootScope = $body.injector().get('$rootScope');   
                $rootScope.$apply(function () {                        
                    $rootScope.searchvalue = val;
                });
            }
        </script>
        
    </head>
    <body>
            <div id="player" class="animated pulse">
            <div id="player-container">
            <a class="cp-close"></a>
            <a class="cp-prev"></a>
            <div id="jquery_jplayer_1" class="cp-jplayer"></div>
			<div id="cp_container_1" class="cp-container">
				<div class="cp-buffer-holder">
					<div class="cp-buffer-1"></div>
					<div class="cp-buffer-2"></div>
				</div>
				<div class="cp-progress-holder"> 
					<div class="cp-progress-1"></div>
					<div class="cp-progress-2"></div>
				</div>
				<div class="cp-circle-control"></div>
				<ul class="cp-controls">
					<li><a class="cp-play" tabindex="1">play</a></li>
					<li><a class="cp-pause" style="display:none;" tabindex="1">pause</a></li> <!-- Needs the inline style here, or jQuery.show() uses display:inline instead of display:block -->
				</ul>
			</div>
            <a class="cp-next"></a>
                <center>
                    <p class="cp-l1">00:25 / 03:57</p>
                    <p class="cp-l2">Аавын зөвлөгөө</p>
                    <p class="cp-l3">Үлгэр</p>
                </center>
            </div>
                
            </div>
        <ion-nav-view></ion-nav-view>
        <script>
           $(document).ready(function(){

        	var myCirclePlayer = new CirclePlayer("#jquery_jplayer_1",
        	{
        		mp3: "http://app.mglradio.com/uploads/contents/1.mp3",
        	}, {
        		cssSelectorAncestor: "#cp_container_1",
        		wmode: "window"
        	});
        });
        </script>
    </body>
</html>